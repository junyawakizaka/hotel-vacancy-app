<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç©ºå®¤ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸï¼ | ãƒ‡ã‚£ã‚ºãƒ‹ãƒ¼ãƒ›ãƒ†ãƒ«äºˆç´„</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .container {
      max-width: 500px;
      width: 100%;
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      overflow: hidden;
    }
    
    .header {
      background: linear-gradient(135deg, #FF6B6B 0%, #FF8E53 100%);
      color: white;
      padding: 30px 20px;
      text-align: center;
    }
    
    .header h1 {
      font-size: 24px;
      margin-bottom: 10px;
    }
    
    .header p {
      font-size: 14px;
      opacity: 0.9;
    }
    
    .content {
      padding: 30px 20px;
    }
    
    .info-row {
      display: flex;
      justify-content: space-between;
      padding: 15px 0;
      border-bottom: 1px solid #eee;
    }
    
    .info-row:last-child {
      border-bottom: none;
    }
    
    .info-label {
      color: #999;
      font-size: 14px;
    }
    
    .info-value {
      font-weight: bold;
      font-size: 16px;
      color: #333;
    }
    
    .hotel-name {
      font-size: 20px;
      font-weight: bold;
      color: #667eea;
      margin-bottom: 20px;
      text-align: center;
    }
    
    .cta-button {
      display: block;
      width: 100%;
      padding: 18px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      text-decoration: none;
      text-align: center;
      border-radius: 12px;
      font-size: 18px;
      font-weight: bold;
      margin-top: 30px;
      transition: transform 0.2s, box-shadow 0.2s;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    }
    
    .cta-button:active {
      transform: scale(0.98);
    }
    
    .notice {
      background: #FFF3CD;
      border-left: 4px solid #FFC107;
      padding: 15px;
      margin-top: 20px;
      border-radius: 8px;
      font-size: 13px;
      color: #856404;
    }
    
    .tips {
      background: #E3F2FD;
      padding: 20px;
      margin-top: 20px;
      border-radius: 8px;
    }
    
    .tips h3 {
      font-size: 16px;
      color: #1976D2;
      margin-bottom: 10px;
    }
    
    .tips ul {
      margin-left: 20px;
      color: #555;
      font-size: 14px;
      line-height: 1.8;
    }
    
    .disclaimer {
      background: #f8f9fa;
      border: 1px solid #dee2e6;
      padding: 15px;
      margin-top: 20px;
      border-radius: 8px;
      font-size: 11px;
      color: #6c757d;
      line-height: 1.6;
    }
    
    .disclaimer h4 {
      font-size: 13px;
      color: #495057;
      margin-bottom: 8px;
    }
    
    .disclaimer p {
      margin: 0;
    }
    
    .loading {
      text-align: center;
      padding: 40px;
      color: #999;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ‰ ç©ºå®¤ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸï¼</h1>
      <p>ãŠæ€¥ããã ã•ã„ã€‚äººæ°—æ—¥ç¨‹ã¯ã™ãã«åŸ‹ã¾ã‚Šã¾ã™</p>
    </div>
    
    <div class="content" id="content">
      <div class="loading">èª­ã¿è¾¼ã¿ä¸­...</div>
    </div>
  </div>

  <script>
    // LINEå†…ãƒ–ãƒ©ã‚¦ã‚¶æ¤œçŸ¥
    function isLINEBrowser() {
      const ua = navigator.userAgent.toLowerCase();
      return ua.includes('line/');
    }

    // å¤–éƒ¨ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ãã‚ˆã†ä¿ƒã™ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤º
    function showBrowserSwitchModal() {
      const modal = document.createElement('div');
      modal.id = 'browser-modal';
      modal.innerHTML = `
        <div style="
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0,0,0,0.8);
          z-index: 9999;
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 20px;
        ">
          <div style="
            background: white;
            border-radius: 16px;
            padding: 30px 20px;
            max-width: 350px;
            text-align: center;
          ">
            <div style="font-size: 48px; margin-bottom: 16px;">ğŸŒ</div>
            <h3 style="font-size: 18px; margin-bottom: 12px; color: #333;">
              å¤–éƒ¨ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ãã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™
            </h3>
            <p style="font-size: 14px; color: #666; line-height: 1.6; margin-bottom: 20px;">
              äºˆç´„ã‚’ã‚¹ãƒ ãƒ¼ã‚ºã«è¡Œã†ãŸã‚ã€Safariã‚„Chromeãªã©ã®
              ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ãç›´ã—ã¦ãã ã•ã„ã€‚
            </p>
            <div style="margin-bottom: 16px;">
              <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 100'%3E%3Ctext x='10' y='40' font-size='14' fill='%23666'%3E1. å³ä¸Šã®ã€Œï¸™ã€ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’ã‚¿ãƒƒãƒ—%3C/text%3E%3Ctext x='10' y='70' font-size='14' fill='%23666'%3E2. ã€Œä»–ã®ã‚¢ãƒ—ãƒªã§é–‹ãã€ã‚’é¸æŠ%3C/text%3E%3C/svg%3E" 
                   style="width: 100%; height: auto;" alt="æ‰‹é †">
            </div>
            <button onclick="document.getElementById('browser-modal').remove()" style="
              width: 100%;
              padding: 14px;
              background: #667eea;
              color: white;
              border: none;
              border-radius: 8px;
              font-size: 16px;
              font-weight: bold;
              cursor: pointer;
            ">
              ã“ã®ã¾ã¾ç¶šã‘ã‚‹
            </button>
          </div>
        </div>
      `;
      document.body.appendChild(modal);
    }

    // URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å–å¾—
    const params = new URLSearchParams(window.location.search);
    const hotelId = params.get('hotel');
    const hotelName = params.get('name');  // â† æ–°è¦è¿½åŠ 
    const checkinDate = params.get('date');
    const adults = params.get('adults') || '2';
    const children = params.get('children') || '0';

    if (!hotelId || !checkinDate) {
      document.getElementById('content').innerHTML = 
        '<p style="text-align:center;color:#999;">ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒä¸æ­£ã§ã™</p>';
    } else {
      // LINEå†…ãƒ–ãƒ©ã‚¦ã‚¶ãƒã‚§ãƒƒã‚¯
      if (isLINEBrowser()) {
        showBrowserSwitchModal();
      }

      // ãƒ›ãƒ†ãƒ«åï¼ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰å–å¾—ã€ãªã‘ã‚Œã°ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰
      const displayHotelName = hotelName || `ãƒ›ãƒ†ãƒ«ID: ${hotelId}`;
      
      // ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆæ—¥ï¼ˆç¿Œæ—¥ï¼‰
      const checkoutDate = (() => {
        const d = new Date(checkinDate);
        d.setDate(d.getDate() + 1);
        return d.toISOString().slice(0, 10);
      })();

      // ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆãƒªãƒ³ã‚¯ç”Ÿæˆ
      const affiliateUrl = buildAffiliateUrl(hotelId, checkinDate, checkoutDate, adults);

      // æ—¥ä»˜ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
      const formatDate = (dateStr) => {
        const d = new Date(dateStr);
        return `${d.getFullYear()}å¹´${d.getMonth()+1}æœˆ${d.getDate()}æ—¥`;
      };

      // æ›œæ—¥å–å¾—
      const dayOfWeek = ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'];
      const dow = dayOfWeek[new Date(checkinDate).getDay()];

      // ãƒšãƒ¼ã‚¸ç”Ÿæˆ
      document.getElementById('content').innerHTML = `
        <div class="hotel-name">${displayHotelName}</div>
        
        <div class="info-row">
          <span class="info-label">ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³</span>
          <span class="info-value">${formatDate(checkinDate)}ï¼ˆ${dow}ï¼‰</span>
        </div>
        
        <div class="info-row">
          <span class="info-label">ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ</span>
          <span class="info-value">${formatDate(checkoutDate)}</span>
        </div>
        
        <div class="info-row">
          <span class="info-label">å®¿æ³Šäººæ•°</span>
          <span class="info-value">å¤§äºº ${adults}å / å­ä¾› ${children}å</span>
        </div>

        <a href="${affiliateUrl}" class="cta-button" id="bookingButton">
          ä»Šã™ãäºˆç´„ã™ã‚‹
        </a>

        <div class="notice">
          âš ï¸ <strong>é‡è¦ãªãŠçŸ¥ã‚‰ã›</strong><br>
          ç©ºå®¤ã¯å…ˆç€é †ã§ã™ã€‚ã“ã®ãƒšãƒ¼ã‚¸ã‚’é–‹ã„ã¦ã„ã‚‹é–“ã«æº€å®¤ã«ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚<br>
          ãŠæ—©ã‚ã®äºˆç´„ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚
        </div>

        <div class="tips">
          <h3>ğŸ“ äºˆç´„ã®ã‚³ãƒ„</h3>
          <ul>
            <li>è¤‡æ•°ã®ãƒ—ãƒ©ãƒ³ã‚’æ¯”è¼ƒã—ã¦ã¿ã¾ã—ã‚‡ã†</li>
            <li>æ¥½å¤©ãƒã‚¤ãƒ³ãƒˆã‚’æ´»ç”¨ã™ã‚‹ã¨ãŠå¾—ã§ã™</li>
            <li>ã‚­ãƒ£ãƒ³ã‚»ãƒ«ãƒãƒªã‚·ãƒ¼ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†</li>
            <li>æœé£Ÿä»˜ããƒ»ç´ æ³Šã¾ã‚Šã‚’é¸ã¹ã¾ã™</li>
          </ul>
        </div>

        <div class="disclaimer">
          <h4>å…è²¬äº‹é …</h4>
          <p>
            â€¢ å½“ã‚µãƒ¼ãƒ“ã‚¹ã¯ç©ºå®¤æƒ…å ±ã‚’é€šçŸ¥ã™ã‚‹ã‚‚ã®ã§ã‚ã‚Šã€äºˆç´„ã‚’ä¿è¨¼ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚<br>
            â€¢ é€šçŸ¥æ™‚ç‚¹ã§ã¯ç©ºå®¤ãŒã‚ã‚Šã¾ã—ãŸãŒã€äºˆç´„ãƒšãƒ¼ã‚¸ã‚’é–‹ã„ãŸæ™‚ç‚¹ã§æ—¢ã«æº€å®¤ã«ãªã£ã¦ã„ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚<br>
            â€¢ äºˆç´„ã®æˆå¦ã‚„å®¿æ³Šã«é–¢ã™ã‚‹ãƒˆãƒ©ãƒ–ãƒ«ã«ã¤ã„ã¦ã¯ã€å½“ã‚µãƒ¼ãƒ“ã‚¹ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã‹ã­ã¾ã™ã€‚<br>
            â€¢ äºˆç´„å†…å®¹ã®ç¢ºèªã‚„å¤‰æ›´ãƒ»ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã¯ã€æ¥½å¤©ãƒˆãƒ©ãƒ™ãƒ«ã®è¦ç´„ã«å¾“ã£ã¦ãã ã•ã„ã€‚
          </p>
        </div>
      `;

      // ã‚¯ãƒªãƒƒã‚¯è¨ˆæ¸¬ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
      document.getElementById('bookingButton').addEventListener('click', () => {
        // Google Analyticsãªã©ã§ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°å¯èƒ½
        console.log('äºˆç´„ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯:', displayHotelName, checkinDate);
      });
    }

    // ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆURLç”Ÿæˆ
    function buildAffiliateUrl(hotelId, checkinDateStr, checkoutDateStr, adults) {
      const [y1, m1, d1] = checkinDateStr.split("-").map(s => parseInt(s, 10));
      const [y2, m2, d2] = checkoutDateStr.split("-").map(s => parseInt(s, 10));

      // æ¥½å¤©ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆIDï¼ˆç’°å¢ƒå¤‰æ•°ã‹ã‚‰å–å¾—ã™ã‚‹å ´åˆã¯åˆ¥é€”APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆçµŒç”±ï¼‰
      const AFFILIATE_ID = 'YOUR_AFFILIATE_ID'; // ã“ã“ã«å®Ÿéš›ã®IDã‚’è¨­å®š

      const inner =
        `https://hotel.travel.rakuten.co.jp/hotelinfo/plan/${hotelId}` +
        `?f_flg=PLAN&f_teikei=&f_hizuke=&f_hak=&f_dai=japan&f_chu=tiba&f_shou=keiyo&f_sai=&f_tel=&f_target_flg=` +
        `&f_tscm_flg=&f_p_no=&f_custom_code=&f_search_type=&f_camp_id=&f_static=1&f_rm_equip=` +
        `&f_hi1=${d1}&f_tuki1=${m1}&f_nen1=${y1}` +
        `&f_hi2=${d2}&f_tuki2=${m2}&f_nen2=${y2}` +
        `&f_heya_su=1&f_otona_su=${adults}` +
        `&f_s1=0&f_s2=0&f_y1=0&f_y2=0&f_y3=0&f_y4=0&f_kin2=0&f_kin=`;

      return `https://hb.afl.rakuten.co.jp/hgc/${AFFILIATE_ID}/?pc=` + encodeURIComponent(inner);
    }
  </script>
</body>
</html>
