<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç©ºå®¤ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸï¼ | ãƒ‡ã‚£ã‚ºãƒ‹ãƒ¼ãƒ›ãƒ†ãƒ«ç©ºå®¤ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼</title>
  <meta name="description" content="ãƒ‡ã‚£ã‚ºãƒ‹ãƒ¼ãƒ›ãƒ†ãƒ«ã®ç©ºå®¤ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸã€‚ãŠæ—©ã‚ã®ã”äºˆç´„ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚">
  <style>
    :root{
      --bg:#fafafa; --card:#fff; --txt:#222; --muted:#687076;
      --ok:#16a34a; --ng:#d1d5db; --sat:#e8f2ff; --sun:#ffecef;
      --accent:#2563eb; --sticky:#fff;
      --radius:14px;
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--bg);color:var(--txt);font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Hiragino Kaku Gothic ProN","Yu Gothic UI","Noto Sans JP",sans-serif;line-height:1.45}
    h1,h2,h3,p{margin:0}

    body {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .page-header {
      padding: 20px 16px;
      text-align: center;
      background: var(--card);
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    }

    .page-header h1 {
      font-size: 20px;
      font-weight: 700;
      color: var(--txt);
    }

    .page-header .sub {
      color: var(--muted);
      font-size: 13px;
      margin-top: 6px;
    }

    .container {
      flex: 1;
      max-width: 720px;
      width: 100%;
      margin: 0 auto;
      padding: 16px 12px 40px;
    }

    .card {
      background: var(--card);
      border-radius: var(--radius);
      margin-bottom: 12px;
      padding: 18px 16px;
      box-shadow: 0 2px 10px rgba(0,0,0,.04);
    }

    .alert-card {
      background: linear-gradient(135deg, #FF6B6B 0%, #FF8E53 100%);
      color: white;
      text-align: center;
      padding: 24px 16px;
    }

    .alert-card .icon {
      font-size: 48px;
      margin-bottom: 8px;
    }

    .alert-card h2 {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 6px;
    }

    .alert-card p {
      font-size: 13px;
      opacity: 0.95;
    }

    .hotel-name {
      font-size: 18px;
      font-weight: 700;
      color: var(--accent);
      margin-bottom: 16px;
      padding-bottom: 8px;
      border-bottom: 2px solid #e5e7eb;
    }

    .info-grid {
      display: grid;
      gap: 12px;
      margin-bottom: 20px;
    }

    .info-row {
      display: flex;
      justify-content: space-between;
      padding: 10px 0;
      border-bottom: 1px solid #f0f2f5;
    }

    .info-row:last-child {
      border-bottom: none;
    }

    .info-label {
      color: var(--muted);
      font-size: 13px;
      font-weight: 600;
    }

    .info-value {
      font-weight: 700;
      font-size: 15px;
      color: var(--txt);
      text-align: right;
    }

    .cta-button {
      display: block;
      width: 100%;
      padding: 16px;
      background: var(--accent);
      color: white;
      text-decoration: none;
      text-align: center;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 700;
      transition: all 0.15s ease;
      box-shadow: 0 2px 8px rgba(37, 99, 235, 0.3);
    }

    .cta-button:active {
      transform: translateY(1px);
    }

    .notice {
      background: #FFF3CD;
      border-left: 4px solid #FFC107;
      padding: 14px;
      border-radius: 8px;
      font-size: 13px;
      color: #856404;
      line-height: 1.6;
    }

    .notice strong {
      display: block;
      margin-bottom: 4px;
    }

    .tips {
      background: #EEF2FF;
      padding: 16px;
      border-radius: 12px;
    }

    .tips h3 {
      font-size: 14px;
      color: #3730a3;
      margin-bottom: 10px;
      font-weight: 700;
    }

    .tips ul {
      margin: 0;
      padding-left: 20px;
      font-size: 13px;
      color: #374151;
      line-height: 1.8;
    }

    .tips li {
      margin-bottom: 6px;
    }

    .disclaimer {
      background: #f8f9fa;
      border: 1px solid #dee2e6;
      padding: 14px;
      border-radius: 8px;
      font-size: 11px;
      color: #6c757d;
      line-height: 1.6;
    }

    .disclaimer h4 {
      font-size: 12px;
      color: #495057;
      margin-bottom: 8px;
      font-weight: 700;
    }

    .disclaimer p {
      margin: 0;
    }

    .loading {
      text-align: center;
      padding: 40px;
      color: var(--muted);
    }

    .app-footer {
      padding: 20px 16px 34px;
      text-align: center;
      color: var(--muted);
      font-size: 12px;
      background: var(--card);
      border-top: 1px solid #f0f2f5;
      margin-top: auto;
    }

    .app-footer a {
      color: var(--accent);
      text-decoration: none;
      font-weight: 500;
    }

    .app-footer a:hover {
      text-decoration: underline;
    }

    /* LINEå†…ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¢ãƒ¼ãƒ€ãƒ« */
    #browser-modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.8);
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    #browser-modal .modal-content {
      background: white;
      border-radius: 16px;
      padding: 30px 20px;
      max-width: 350px;
      text-align: center;
    }

    #browser-modal .modal-icon {
      font-size: 48px;
      margin-bottom: 16px;
    }

    #browser-modal h3 {
      font-size: 18px;
      margin-bottom: 12px;
      color: #333;
    }

    #browser-modal p {
      font-size: 14px;
      color: #666;
      line-height: 1.6;
      margin-bottom: 20px;
    }

    #browser-modal .instructions {
      background: #f9fafb;
      padding: 12px;
      border-radius: 8px;
      font-size: 13px;
      color: #374151;
      margin-bottom: 16px;
      line-height: 1.6;
    }

    #browser-modal button {
      width: 100%;
      padding: 14px;
      background: var(--accent);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
    }

    @media (max-width: 360px) {
      .container {
        padding: 14px 10px 30px;
      }
      .card {
        padding: 14px 12px;
      }
    }
  </style>
</head>
<body>
  <header class="page-header">
    <h1>ãƒ‡ã‚£ã‚ºãƒ‹ãƒ¼ãƒ›ãƒ†ãƒ« ç©ºå®¤ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼</h1>
    <p class="sub">ç©ºå®¤ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸï¼ãŠæ—©ã‚ã®ã”äºˆç´„ã‚’ãŠã™ã™ã‚ã—ã¾ã™</p>
  </header>

  <div class="container">
    <div class="card alert-card">
      <div class="icon">ğŸ‰</div>
      <h2>ç©ºå®¤ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸï¼</h2>
      <p>äººæ°—æ—¥ç¨‹ã®ãŸã‚æ—©æœŸæº€å®¤ã®å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™</p>
    </div>

    <div class="card" id="content">
      <div class="loading">èª­ã¿è¾¼ã¿ä¸­...</div>
    </div>
  </div>

  <footer class="app-footer">
    <p>
      <a href="/">â† ç©ºå®¤ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã«æˆ»ã‚‹</a>
    </p>
    <small>
      Â© 2025 
      <a href="https://x.com/brpwh54023" target="_blank" rel="noopener">
        ãƒ‡ã‚£ã‚ºãƒ‹ãƒ¼ãƒ›ãƒ†ãƒ« ã‚­ãƒ£ãƒ³ã‚»ãƒ«ãƒ»ç©ºå®¤é€šçŸ¥ bot
      </a>
    </small>
  </footer>

  <script>
    // LINEå†…ãƒ–ãƒ©ã‚¦ã‚¶æ¤œçŸ¥
    function isLINEBrowser() {
      const ua = navigator.userAgent.toLowerCase();
      return ua.includes('line/');
    }

    // å¤–éƒ¨ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ãã‚ˆã†ä¿ƒã™ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤º
    function showBrowserSwitchModal() {
      const modal = document.createElement('div');
      modal.id = 'browser-modal';
      modal.innerHTML = `
        <div class="modal-content">
          <div class="modal-icon">ğŸŒ</div>
          <h3>å¤–éƒ¨ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ãã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™</h3>
          <p>äºˆç´„ã‚’ã‚¹ãƒ ãƒ¼ã‚ºã«è¡Œã†ãŸã‚ã€Safariã‚„Chromeãªã©ã®ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ãç›´ã—ã¦ãã ã•ã„ã€‚</p>
          <div class="instructions">
            1. å³ä¸Šã®ã€Œï¸™ã€ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’ã‚¿ãƒƒãƒ—<br>
            2. ã€Œä»–ã®ã‚¢ãƒ—ãƒªã§é–‹ãã€ã‚’é¸æŠ
          </div>
          <button onclick="document.getElementById('browser-modal').remove()">
            ã“ã®ã¾ã¾ç¶šã‘ã‚‹
          </button>
        </div>
      `;
      document.body.appendChild(modal);
    }

    // URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å–å¾—
    const params = new URLSearchParams(window.location.search);
    const hotelId = params.get('hotel');
    const hotelName = params.get('name');
    const checkinDate = params.get('date');
    const adults = params.get('adults') || '2';
    const children = params.get('children') || '0';

    if (!hotelId || !checkinDate) {
      document.getElementById('content').innerHTML = 
        '<p style="text-align:center;color:#999;">ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒä¸æ­£ã§ã™</p>';
    } else {
      // LINEå†…ãƒ–ãƒ©ã‚¦ã‚¶ãƒã‚§ãƒƒã‚¯
      if (isLINEBrowser()) {
        showBrowserSwitchModal();
      }

      // ãƒ›ãƒ†ãƒ«åï¼ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰å–å¾—ã€ãªã‘ã‚Œã°ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰
      const displayHotelName = hotelName || `ãƒ›ãƒ†ãƒ«ID: ${hotelId}`;
      
      // ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆæ—¥ï¼ˆç¿Œæ—¥ï¼‰
      const checkoutDate = (() => {
        const d = new Date(checkinDate);
        d.setDate(d.getDate() + 1);
        return d.toISOString().slice(0, 10);
      })();

      // ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆãƒªãƒ³ã‚¯ç”Ÿæˆ
      const affiliateUrl = buildAffiliateUrl(hotelId, checkinDate, checkoutDate, adults);

      // æ—¥ä»˜ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
      const formatDate = (dateStr) => {
        const d = new Date(dateStr);
        return `${d.getFullYear()}å¹´${d.getMonth()+1}æœˆ${d.getDate()}æ—¥`;
      };

      // æ›œæ—¥å–å¾—
      const dayOfWeek = ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'];
      const dow = dayOfWeek[new Date(checkinDate).getDay()];

      // ãƒšãƒ¼ã‚¸ç”Ÿæˆ
      document.getElementById('content').innerHTML = `
        <div class="hotel-name">${displayHotelName}</div>
        
        <div class="info-grid">
          <div class="info-row">
            <span class="info-label">ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³</span>
            <span class="info-value">${formatDate(checkinDate)}ï¼ˆ${dow}ï¼‰</span>
          </div>
          
          <div class="info-row">
            <span class="info-label">ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ</span>
            <span class="info-value">${formatDate(checkoutDate)}</span>
          </div>
          
          <div class="info-row">
            <span class="info-label">å®¿æ³Šäººæ•°</span>
            <span class="info-value">å¤§äºº ${adults}å / å­ä¾› ${children}å</span>
          </div>
        </div>

        <a href="${affiliateUrl}" class="cta-button" id="bookingButton">
          ä»Šã™ãäºˆç´„ã™ã‚‹
        </a>
      `;

      // è¿½åŠ æƒ…å ±ã‚«ãƒ¼ãƒ‰
      const additionalInfo = document.createElement('div');
      additionalInfo.innerHTML = `
        <div class="card notice">
          <strong>âš ï¸ é‡è¦ãªãŠçŸ¥ã‚‰ã›</strong>
          ç©ºå®¤ã¯å…ˆç€é †ã§ã™ã€‚ã“ã®ãƒšãƒ¼ã‚¸ã‚’é–‹ã„ã¦ã„ã‚‹é–“ã«æº€å®¤ã«ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚<br>
          ãŠæ—©ã‚ã®äºˆç´„ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚
        </div>

        <div class="card tips">
          <h3>ğŸ“ äºˆç´„ã®ã‚³ãƒ„</h3>
          <ul>
            <li>è¤‡æ•°ã®ãƒ—ãƒ©ãƒ³ã‚’æ¯”è¼ƒã—ã¦ã¿ã¾ã—ã‚‡ã†</li>
            <li>æ¥½å¤©ãƒã‚¤ãƒ³ãƒˆã‚’æ´»ç”¨ã™ã‚‹ã¨ãŠå¾—ã§ã™</li>
            <li>ã‚­ãƒ£ãƒ³ã‚»ãƒ«ãƒãƒªã‚·ãƒ¼ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†</li>
            <li>æœé£Ÿä»˜ããƒ»ç´ æ³Šã¾ã‚Šã‚’é¸ã¹ã¾ã™</li>
          </ul>
        </div>

        <div class="card disclaimer">
          <h4>å…è²¬äº‹é …</h4>
          <p>
            â€¢ å½“ã‚µãƒ¼ãƒ“ã‚¹ã¯ç©ºå®¤æƒ…å ±ã‚’é€šçŸ¥ã™ã‚‹ã‚‚ã®ã§ã‚ã‚Šã€äºˆç´„ã‚’ä¿è¨¼ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚<br>
            â€¢ é€šçŸ¥æ™‚ç‚¹ã§ã¯ç©ºå®¤ãŒã‚ã‚Šã¾ã—ãŸãŒã€äºˆç´„ãƒšãƒ¼ã‚¸ã‚’é–‹ã„ãŸæ™‚ç‚¹ã§æ—¢ã«æº€å®¤ã«ãªã£ã¦ã„ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚<br>
            â€¢ äºˆç´„ã®æˆå¦ã‚„å®¿æ³Šã«é–¢ã™ã‚‹ãƒˆãƒ©ãƒ–ãƒ«ã«ã¤ã„ã¦ã¯ã€å½“ã‚µãƒ¼ãƒ“ã‚¹ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã‹ã­ã¾ã™ã€‚<br>
            â€¢ äºˆç´„å†…å®¹ã®ç¢ºèªã‚„å¤‰æ›´ãƒ»ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã¯ã€æ¥½å¤©ãƒˆãƒ©ãƒ™ãƒ«ã®è¦ç´„ã«å¾“ã£ã¦ãã ã•ã„ã€‚
          </p>
        </div>
      `;
      
      document.querySelector('.container').appendChild(additionalInfo);

      // ã‚¯ãƒªãƒƒã‚¯è¨ˆæ¸¬ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
      document.getElementById('bookingButton').addEventListener('click', () => {
        console.log('äºˆç´„ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯:', displayHotelName, checkinDate);
      });
    }

    // ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆURLç”Ÿæˆ
    function buildAffiliateUrl(hotelId, checkinDateStr, checkoutDateStr, adults) {
      const [y1, m1, d1] = checkinDateStr.split("-").map(s => parseInt(s, 10));
      const [y2, m2, d2] = checkoutDateStr.split("-").map(s => parseInt(s, 10));

      // æ¥½å¤©ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆIDï¼ˆå®Ÿéš›ã®IDã«ç½®ãæ›ãˆï¼‰
      const AFFILIATE_ID = '4bfb9c3a.dba8952b.4bce44bb.c84df6cc';

      const inner =
        `https://hotel.travel.rakuten.co.jp/hotelinfo/plan/${hotelId}` +
        `?f_flg=PLAN&f_teikei=&f_hizuke=&f_hak=&f_dai=japan&f_chu=tiba&f_shou=keiyo&f_sai=&f_tel=&f_target_flg=` +
        `&f_tscm_flg=&f_p_no=&f_custom_code=&f_search_type=&f_camp_id=&f_static=1&f_rm_equip=` +
        `&f_hi1=${d1}&f_tuki1=${m1}&f_nen1=${y1}` +
        `&f_hi2=${d2}&f_tuki2=${m2}&f_nen2=${y2}` +
        `&f_heya_su=1&f_otona_su=${adults}` +
        `&f_s1=0&f_s2=0&f_y1=0&f_y2=0&f_y3=0&f_y4=0&f_kin2=0&f_kin=`;

      return `https://hb.afl.rakuten.co.jp/hgc/${AFFILIATE_ID}/?pc=` + encodeURIComponent(inner);
    }
  </script>
</body>
</html>
